# Global Lock Violation Fix

## Analysis
The user reported that the AI ignored the "Global Lock" rule (Forbid new positions if any position < 45m).
Upon investigation, it was found that the "Current Positions" section in the AI prompt (generated by `kernel/formatter.go`) **does not include** the Entry Time or Holding Duration.
Without this information, the AI cannot verify the rule state and defaults to ignoring it.

## Proposed Changes

### [MODIFY] [kernel/formatter.go](file:///d:/code/nofx-0210/kernel/formatter.go)
- Update `formatCurrentPositionsZH` and `formatCurrentPositionsEN` to:
  - Calculate `HoldDuration` using `pos.UpdateTime` (which stores the entry time) and `ctx.CurrentTime` (or `time.Now()`).
  - Append the duration string (e.g., "Duration: 15m") to the position details line.
  - Append the entry time string (e.g., "Entry Time: 12:40") for clarity.

## Verification Plan
1.  **Code Review**: Verify that the calculated duration is correct and formatted legibly.
2.  **Simulation**: Since we cannot run the live trading loop, we will verify the code changes ensure the data is present in the string builder.
